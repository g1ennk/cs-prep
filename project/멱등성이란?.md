## 멱등성이란?

### 1. 정의
멱등성(Idempotency)이란 동일한 연산을 한 번 수행하든 여러 번 반복 수행하든 결과가 동일하게 나오는 성질을 의미한다.

수학에서 유래된 개념으로, 분산 시스템과 API 설계에서 중요한 원칙 중 하나이다.

### 2. 종류
- **HTTP 메서드별 멱등성**
  - GET: 멱등성 O (리소스 조회, 서버 상태 변경 없음)
  - PUT: 멱등성 O (전체 리소스 교체, 동일한 결과 보장)
  - DELETE: 멱등성 O (리소스 삭제, 이미 없어도 동일한 상태)
  - POST: 멱등성 X (새 리소스 생성, 매번 다른 결과)
  - PATCH: 멱등성 X (부분 수정, 구현에 따라 다름)

- **데이터베이스 연산**
  - SELECT: 멱등성 O
  - UPDATE (절대값): 멱등성 O (SET age = 25)
  - UPDATE (상대값): 멱등성 X (SET age = age + 1)
  - INSERT: 멱등성 X (중복 키 제약 제외)
  - DELETE: 멱등성 O

### 3. 특징
- **장점**
  - 네트워크 장애 시 안전한 재시도 가능
  - 시스템 예측 가능성과 신뢰성 향상
  - 분산 환경에서 일관성 보장
  - 캐싱 최적화 가능

- **단점**
  - 구현 복잡도 증가 (중복 요청 처리 로직 필요)
  - 성능 오버헤드 (상태 확인, 검증 과정)
  - 비즈니스 로직과의 충돌 가능성

### 4. 사례
- **파일 삭제**: `rm file.txt`를 여러 번 실행해도 결과는 동일 (파일이 없는 상태)
- **사용자 정보 수정**: PUT /users/123 {"name": "홍길동"} 여러 번 호출해도 이름은 "홍길동"
- **상품 조회**: GET /products/456을 반복 호출해도 동일한 상품 정보 반환
- **주문 생성**: POST /orders를 여러 번 호출하면 중복 주문 발생 (비멱등성)
- **결제 API**: 동일한 결제 요청 ID로 여러 번 호출해도 한 번만 결제 처리

### 5. 결론
멱등성은 분산 시스템과 API 설계에서 안정성과 신뢰성을 보장하는 핵심 원칙이다. 네트워크 장애나 시스템 오류 상황에서도 안전한 재시도를 가능하게 하며, 예측 가능한 동작을 통해 시스템의 일관성을 유지한다. 구현 시에는 중복 요청 처리와 상태 관리에 대한 추가적인 고려가 필요하지만, 장기적으로는 시스템의 견고성을 크게 향상시킨다.


## 매일메일
멱등성이란 동일한 요청을 한 번 수행하든 여러 번 수행하든 결과가 동일하게 나오는 성질을 말합니다.

HTTP 메서드를 예로 들어 설명드리겠습니다.

GET 요청은 멱등성을 가집니다. 사용자 정보를 조회하는 API를 10번 호출해도 동일한 사용자 정보가 반환되고, 서버 상태에는 변화가 없습니다.

PUT 요청도 멱등성을 가집니다. 사용자의 이름을 "홍길동"으로 변경하는 요청을 여러 번 보내도, 결국 이름은 "홍길동"으로 설정되어 있습니다. 전체 리소스를 교체하는 방식이기 때문에 몇 번을 호출하든 동일한 최종 상태가 됩니다.

DELETE 요청 역시 멱등성을 가집니다. 특정 파일을 삭제하는 명령을 여러 번 실행해도, 첫 번째 실행 후에는 이미 파일이 없는 상태이므로 "파일이 없다"는 동일한 결과가 유지됩니다.

반면 POST 요청은 비멱등성입니다. 주문 생성 API를 여러 번 호출하면 매번 새로운 주문이 생성되어 중복 주문이 발생할 수 있습니다. 같은 요청이라도 매번 다른 결과를 만들어내기 때문입니다.

실제 개발에서는 결제 시스템에서 멱등성이 특히 중요합니다. 동일한 결제 요청 ID로 여러 번 API를 호출해도 실제로는 한 번만 결제가 처리되도록 구현해야 합니다.

멱등성은 네트워크 장애나 타임아웃 상황에서 안전한 재시도를 가능하게 하고, 시스템의 예측 가능성을 높여주는 중요한 설계 원칙입니다. 다만 구현할 때는 중복 요청을 감지하고 처리하는 추가적인 로직이 필요하며, 이로 인한 성능 오버헤드도 고려해야 합니다.

즉, 멱등성은 분산 시스템에서 일관성과 신뢰성을 보장하는 핵심 개념으로, HTTP 메서드별 특성을 이해하고 비즈니스 로직에 적절히 적용하는 것이 중요합니다.