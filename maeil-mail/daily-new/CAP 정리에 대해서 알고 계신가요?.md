# CAP 정리에 대해서 알고 계신가요?

## 요약

### 1. 정의
CAP 정리는 분산 시스템에서 일관성(Consistency), 가용성(Availability), 분할 내성(Partition Tolerance) 세 가지 속성 중 최대 두 개만 동시에 만족할 수 있다는 이론이다. 에릭 브루어가 제시한 이 정리는 분산 데이터베이스 설계의 핵심 원칙이다.

### 2. 구성 요소
- **일관성(Consistency)**: 모든 노드가 동시에 같은 데이터를 보는 것
- **가용성(Availability)**: 시스템이 항상 요청에 응답할 수 있는 것  
- **분할 내성(Partition Tolerance)**: 네트워크 분할 상황에서도 시스템이 동작하는 것

### 3. 시스템 유형별 특징
- **CP 시스템**: 일관성+분할내성, 가용성 희생 (MongoDB, HBase, Redis Cluster)
- **AP 시스템**: 가용성+분할내성, 일관성 희생 (Cassandra, DynamoDB, CouchDB)  
- **CA 시스템**: 일관성+가용성, 분할내성 희생 (RDBMS, 단일 데이터센터 시스템)

### 4. 실제 적용 사례
- **CP 선택**: 금융 시스템, 재고 관리 - 데이터 정확성이 최우선
- **AP 선택**: 소셜미디어, 추천시스템 - 서비스 연속성이 중요
- **네트워크 분할 시 대응**: 쓰기 중단 vs 최종 일관성(Eventually Consistency)

### 5. 결론
CAP 정리는 완벽한 분산 시스템이 불가능함을 보여주며, 비즈니스 요구사항에 따라 트레이드오프를 선택해야 함을 강조한다. 현실적으로는 CP나 AP 중 선택하고, 부족한 부분을 보완하는 전략이 필요하다.

## 발화

CAP 정리는 분산 시스템 설계에서 반드시 알아야 할 핵심 이론입니다.

일관성, 가용성, 분할 내성 이 세 가지를 모두 만족하는 분산 시스템은 존재하지 않고, 최대 두 개만 선택할 수 있다는 게 핵심입니다.

현실에선 네트워크 분할은 현실에서 피할 수 없기 때문에, 실제로는 CP와 AP 중에서 선택하게 됩니다.

CP 시스템을 선택하면 네트워크 분할이 발생했을 때 일관성을 지키기 위해 서비스를 중단합니다. 예를 들어 MongoDB나 Redis Cluster 같은 경우인데, 금융 시스템처럼 데이터 정확성이 생명인 곳에서 주로 사용합니다.

반대로 AP 시스템은 네트워크 문제가 있어도 서비스는 계속 제공합니다. 대신 일시적으로 데이터가 다를 수 있지만, 나중에 동기화해서 최종 일관성을 맞춰줍니다. Cassandra나 DynamoDB가 대표적이고, 소셜미디어 피드같이 약간의 데이터 차이보다는 서비스 연속성이 더 중요한 곳에 적합합니다.

결국 CAP 정리는 "완벽한 분산 시스템은 없다"는 걸 알려주면서, 상황에 맞는 트레이드오프를 선택하라고 가이드해주는 이론입니다.

---

## 추가 학습 자료

- [기계인간 John Grib - CAP 정리](https://johngrib.github.io/wiki/CAP-theorem/)
- [매일메일 - CAP 정리에 대해서 알고 계신가요?](https://maeilmail.kr/)
