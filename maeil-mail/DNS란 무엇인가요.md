# DNS란 무엇인가요

## 요약

### DNS란?

- 컴퓨터 간 통신은 숫자로 이루어진 IP 주소로 이루어지지만, 이는 사람이 기억하고 다루기 어렵기 때문에 웹 서비스는 도메인 주소를 사용한다.
- DNS란, 도메인 주소에 대응되는 원격 호스트 IP 주소를 관리하고 질의할 수 있는 시스템 혹은 이를 이용하기 위한 프로토콜을 의미한다.
- 또한 DNS 시스템 내에 도메인 주소를 관리하는 서버를 네임 서버라고 한다.

### DNS의 질의 과정은?

- DNS를 통해 IP 주소를 찾는 과정은 `로컬 네임 서버`, `루트 네임 서버`, `TLD 네임 서버`, `권한 네임 서버`가 포함된다.
    1. Local Name Server: 통신사 DNS, 구글 DNS처럼 클라이언트와 가장 가까이 존재하는 네임 서버
    2. Root Name Server: 루트 도메인을 관리하는 서버이며, TLD 네임 서버의 주소를 알고 있다.
    3. TLD(Top-Level Domain Server) Name Server: .com, .kr, .net을 운영하는 네임 서버
    4. Authoritative Name Server: 네트워크를 운영하는 기관에서 보유하고 있는 도메인을 관리하는 네임 서버

- 질의 과정
    1. 클라이언트 -> 로컬 네임 서버
        - 사용자가 `api.maeil.mail.kr`을 입력하면 먼저 `로컬 네임 서버`에 IP 주소를 물어본다.
        - 만약 캐시에 IP 정보가 있다면 곧바로 응답하면 끝이다.
        - 캐시가 없다면, 로컬 네임 서버가 직접 DNS 탐색을 시작한다.
    2. 로컬 네임 서버 -> 루트 네임 서버
        - 로컬 네임 서버가 루트 네임 서버에 질의한다.
        - 루트 네임 서버는 모든 최상위 도메인 TLD 주소를 알고 있기에 실제 IP를 주지 않고 해당 .kr을 담당하는 TLD 네임 서버 주소로 응답한다.
    3. 로컬 네임 서버 -> TLD 네임 서버(.kr)
        - 루트 네임 서버로부터 받은 TLD 네임 서버에게 .kr을 가진 도메인 중에 필요한 도메인을 관리하는 서버 주소를 요청한다.
        - 그러면 TLD서버가 권한 네임 서버 주소를 알려준다.
    4. 로컬 네임 서버 -> 권한 네임 서버
        - 마지막으로 로컬 네임 서버가 권한 네임 서버에게 도메인 주소를 묻는다.
        - 이후 권한 네임 서버가 실제 IP 주소를 보유하고 있어 로컬 네임 서버에 응답한다.
    5. 응답 캐싱 및 반환
        - 해당 IP를 응답 받은 로컬 네임 서버는 IP 주소를 캐시에 저장해둔다.(TTL 동안 유효)
        - 이후 클라이언트에게 IP 주소를 반환한다.
        - 그러면 이제 클라이언트는 해당 IP로 서버에 연결할 수 있게 된다.

## 발화

사람은 기본적으로 숫자로 된 IP 주소를 잘 기억하지 못하기 때문에 도메인 이름을 IP 주소로 변환하는 DNS 시스템을 활용합니다.

예를 들어 사용자가 브라우저에 www.naver.com을 입력하면,
먼저 클라이언트는 로컬 DNS 서버에 해당 도메인의 IP 주소를 물어봅니다.
만약 캐시에 IP 정보가 이미 있다면 즉시 응답을 받고,
없다면 로컬 DNS 서버는 루트 네임 서버에 질의를 보냅니다.

루트 네임 서버는 모든 최상위 도메인(.com, .kr 등)을 관리하는 서버들의 주소를 알고 있기 때문에
“나는 www.naver.com은 모르지만 .com을 담당하는 TLD 네임 서버 주소를 알려줄게”라고 응답합니다.

그럼 로컬 DNS는 .com TLD 서버에 다시 질의해서
“.com 도메인 중에 naver.com을 관리하는 서버 주소를 알려줘”라고 요청하고,
TLD 서버는 해당 도메인을 관리하는 권한 네임 서버(Authoritative DNS) 주소를 응답합니다.

이제 로컬 DNS 서버는 권한 네임 서버에 최종적으로 요청을 보냅니다.
“www.naver.com의 실제 IP 주소를 알려줘.”
그러면 권한 네임 서버가 “이 도메인의 IP는 203.0.113.25야.”라고 응답하죠.

로컬 DNS는 받은 IP 주소를 캐시에 저장해두고,
이 IP를 클라이언트에게 전달합니다.
이후 클라이언트는 해당 IP를 이용해 실제 웹 서버에 접속하게 됩니다.

결국 DNS 질의는
“로컬 캐시 확인 → 루트 네임 서버 → TLD 네임 서버 → 권한 네임 서버 → IP 응답”
이 순서로 이루어지는 구조입니다.

## 출처

https://www.maeil-mail.kr/question/201


