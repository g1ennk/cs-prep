# 의존성 주입이란 무엇인가요?

## 요약

### 1. 정의

- 의존성 주입(DI,Dependency Injection)이란, 객체가 의존하는 객체를 직접 생성하지 않고 외부에서 주입받는 방식
- IoC(Inversion of Control, 제어의 역전)를 구현하는 핵심 메커니즘 중 하나

### 2. 목적

- 객체 간 결합도 낮추기
- 유연성과 테스트 용이성 확보
- 코드 재사용성 및 유지보수성 향상

### 3. 주입 방식

1. 생성자 주입
    - 불변성 보장
    - 의존성 누락 시 컴파일 타임에 확인 가능
    - 스프링에서 가장 권장되는 방식으로 생성자가 1개라면 `@Autowired` 없이 자동 주입
    ```java
    @Component
    public class OrderServiceImpl implements OrderService {
    
        private final MemberRepository memberRepository;
        private final DiscountPolicy discountPolicy;
    
        @Autowired // 생략 가능(생성자 하나이기 때문에)
        public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
            this.memberRepository = memberRepository;
            this.discountPolicy = discountPolicy;
        }
    }
    ```

2. 세터 주입 (or 메서드 주입)
    - 선택적 의존성, 재설정 가능하므로 선택 및 변경 가능성이 있는 의존관계에 사용한다.
    - 불변성 보장 어려움
    ```java
    // 세터 주입
    @Component
    public class OrderServiceImpl implements OrderService {
    
        @Autowired
        private final MemberRepository memberRepository;
    
        @Autowired
        private final DiscountPolicy discountPolicy;
    }
    
    // 메서드 주입
    @Component
    public class OrderServiceImpl implements OrderService {
    
        private final MemberRepository memberRepository;
        private final DiscountPolicy discountPolicy;
    
        @Autowired
        public void init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
            this.memberRepository = memberRepository;
            this.discountPolicy = discountPolicy;
        }
    }
    ```

3. 필드 주입
    - 간단하지만 테스트가 어렵고, DI 컨테이너 없이는 사용 불가 -> 지양
    - 그냥 사용하지 말자!
    ```java
    @Component
    public class OrderServiceImpl implements OrderService {
    
        @Autowired
        private final MemberRepository memberRepository;
    
        @Autowired
        private final DiscountPolicy discountPolicy;
    }
    ```

### 4. 장단점

- 장점
    - 모듈 간 의존성 약화 -> 변경에 강함
    - 재사용성이 높아지고 가독성도 높아진다.
    - 인터페이스 기반 설계 용이
    - Mock 객체 주입을 통한 단위 테스트 편리
- 단점
    - 설계가 잘못되면 복잡도 증가
    - 모든 것을 DI로 해결하고자한다면 오버 스펙 가능성 존재

## 발화

의존성 주입은 객체가 의존 대상을 생성하는 대신, 외부 다른 객체가 필요한 객체를 주입하는 방식입니다.

예를 들어 A 객체가 B 객체를 필요로 한다면, A가 B를 직접 생성하는 것이 아닌 외부에서 B를 넣어주는 것입니다.

이로 인해 A는 B의 구체 클래스에 의존하지 않고 인터페이스에만 의존할 수 있어서 결합도가 낮아지는 장점이 있습니다.

스프링에선 IoC 컨테이너가 이 주입 과정을 자동으로 관리합니다.

주입 방식에는 생성자, 세터, 필드 이 세 가지 방식이 존재하는데, 생성자 주입이 불변성을 보장하고 의존성을 강제할 수 있어 가장 권장되는 방식입니다.

## 추가 학습 자료

https://www.maeil-mail.kr/question/183
