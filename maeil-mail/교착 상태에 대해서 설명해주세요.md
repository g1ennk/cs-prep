# 교착 상태에 대해서 설명해주세요.

## 1. 정리

### 정의
- 교착 상태란, 두 개 이상의 작업이 서로 상대방의 작업이 끝나기만을 기다리고 있어 결과적으로 아무것도 완료되지 못하는 상태를 의미한다.

### 교착 상태가 발생하는 4가지 조건
1. 상호 배제(mutual exclusion): 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없는 경우
2. 점유 대기(hold and wait): 자원을 할당받은 상태에서 다른 자원을 할당 받기를 기다리는 경우
3. 비선점(non-preemption): 자원의 강제 해제가 불가능하며 프로세스 작업이 끝난 후에만 해제가 가능한 경우
4. 원형 대기(circular wait): 프로세스들이 원의 형태로 자원 할당을 대기하는 경우

### 자바에서 교착 상태를 해결하는 방법
- synchronized 블록 중첩 최소화 -> 점유 대기 조건 제거
- ReentrantLock 사용
  - tryLock(timeout) -> 일정 시간 후 포기
  - lockInterruptible() -> 인터럽트로 교착 해제 가능
- 원칙: 교착 조건 4가지 중 하나를 깨뜨려 설계함으로써 무한 대기를 피하는 방식

## 2. 발화형
교착 상태는 두 개 이상의 작업 혹은 프로세스가 서로 상대방의 자원을 기다리느라 무한정 대기하는 상황을 말합니다.

교착 상태의 발생 조건은 4가지가 존재합니다.

자원을 한 번에 하나만 사용하는 상호 배제, 자원을 가진 상태에서 다른 자원을 기다리는 점유 대기,
자원을 강제로 뺏을 수 없는 비선점, 마지막으로 작업들이 원형의 모양으로 자원을 기다리는 원형 대기입니다.

자바 환경에선 synchronized 때문에 교착이 발생할 수 있는데, 이를 피하기 위해선 해당 블록 중첩을 피하거나, 자원 획득 순서를 강제하거나,
ReentranLock의 `tryLock`(timeout)이나 `lockInterruptible()`을 통해 빠져나오게 할 수 있습니다.

결론적으로 교착 조건의 4가지 중 하나라도 성립하지 않게 설립한다면 교착을 피할 수 있습니다.

## 3. 추가 학습 자료
- [[OS] 데드락(Deadlock)은 언제 발생하고, OS, Java에서 어떻게 해결할까?](https://engineerinsight.tistory.com/290)
- [[JAVA] 자바 쓰레드 동기화(1) - synchronized, wait()/notify()](https://jhkimmm.tistory.com/34)
- [[JAVA] 자바 쓰레드 동기화(2) - ReentrantLock과 Condition](https://jhkimmm.tistory.com/36)
