# 스프링 트랜잭션 전파 속성에 대해서 설명해주세요

## 요약

### 정의

- 전파(propagation)는 이미 시작된 트랜잭션이 있는 상황에서, 새로운 @Transactional 메서드를 호출하면 어떻게 할 것인가를 결정하는 것이다.
- 기본값은 `REQUIRED`

### 전파별 동작 표

| 전파              | 기존 트랜잭션 존재 시                     | 기존 트랜잭션 없음 | 비고 / 사용처                                                                     |
|-----------------|----------------------------------|------------|------------------------------------------------------------------------------|
| `REQUIRED` (기본) | **합류**                           | 새로 시작      | 가장 일반적. 한 단위로 묶고 싶을 때                                                        |
| `REQUIRES_NEW`  | **기존 트랜잭션 일시 정지**, **새 트랜잭션 시작** | 새로 시작      | 독립 커밋/롤백 필요(로그 적재, 알림 기록 등). 외부 롤백 영향 X                                      |
| `SUPPORTS`      | 합류                               | 트랜잭션 없이 실행 | 조회 전용 서비스에 무난                                                                |
| `MANDATORY`     | 합류                               | **예외 발생**  | 반드시 상위가 트랜잭션을 갖고 있어야 함(규약 강제)                                                |
| `NOT_SUPPORTED` | **기존 트랜잭션 정지**, 트랜잭션 없이 실행       | 트랜잭션 없이 실행 | 장시간 I/O, 배치 리포트 등 트랜잭션이 오히려 해로운 작업                                           |
| `NEVER`         | **트랜잭션이 있으면 예외**                 | 트랜잭션 없이 실행 | 의도치 않은 트랜잭션 사용 차단                                                            |
| `NESTED`        | **부모 트랜잭션에 합류 + 세이브포인트 생성**      | 새로 시작      | 부분 롤백이 필요한 경우. **JDBC 기반(DataSourceTransactionManager)에서 동작**, JPA에서는 보통 미지원 |

### 용어 관련

- 합류(join): 같은 물리 트랜잭션 안에서 하나의 커밋과 롤백 운명 공유
- 정지(suspend): 기존 트랜잭션을 잠시 멈추고 별도 트랜잭션 수행
- 세이브포인트(savepoint): 부모 트랜잭션 내 부분 롤백 지점

## 발화

스프링 전파는 이미 트랜잭션이 있는 상황에서 새로운 트랜잭션 메서드 호출 시 어떻게 처리할지를 정하는 속성입니다.
`REQUIRED`는 기본값으로 있다면 합류 없으면 시작이고,\
`REQUIRED_NEW`는 기존 트랜잭션을 정지하고 독립 트랜잭션을 시작하고,\
`SUPPORTS`는 있다면 합류하고, 없다면 트랜잭션 없이 실행하고,\
`MANDATORY`는 합류하되, 없다면 예외를 발생시키고,\
`NOT_SUPPORTED`는 있다면 기존 트랜잭션을 잠시 정지시키고 트랜잭션 없이 실행하고, 없다면 트랜잭션 없이 실행하고,\
`NEVER`은 트랜잭션이 있다면 예외를 발생시키고, 없다면 없이 실행하고,\
`NESTED`는 있다면 부보 트랜잭션에 합료하고 SAVEPOINT를 남기고, 없다면 새로 시작합니다.

따라서 각각의 속성을 잘 이해하고 언제 어떤 속성을 사용할지 아는 것이 중요합니다.

